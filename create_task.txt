CREATE OR REPLACE PROCEDURE public.create_task(
	IN task_id integer,
	IN cp_id integer,
	IN executor integer,
	IN description text,
	IN deadline timestamp without time zone,
	IN priority smallint)
LANGUAGE 'sql'
AS $BODY$


INSERT INTO task (
	task_id
	,c_p_id
	,executor
	,creator
	,task_decription
	,task_create_datetime
	,task_deadline_datetime
	)
VALUES (
	task_id
	,cp_id
	,executor
	,to_regrole(CURRENT_USER)
	,description
	,CURRENT_TIMESTAMP
	,deadline
	);

INSERT INTO task_status (
	task_id
	,task_status_name
	,task_priority
	)
VALUES (
	task_id
	,'N'
	,priority
	);
$BODY$;
ALTER PROCEDURE public.create_task(integer, integer, integer, text, timestamp without time zone, smallint)
    OWNER TO postgres;

GRANT EXECUTE ON PROCEDURE public.create_task(integer, integer, integer, text, timestamp without time zone, smallint) TO postgres;

GRANT EXECUTE ON PROCEDURE public.create_task(integer, integer, integer, text, timestamp without time zone, smallint) TO manager;

GRANT EXECUTE ON PROCEDURE public.create_task(integer, integer, integer, text, timestamp without time zone, smallint) TO admin;

REVOKE ALL ON PROCEDURE public.create_task(integer, integer, integer, text, timestamp without time zone, smallint) FROM PUBLIC;